# Лабораторна робота №6: Фінальний проєкт - Гра "Сапер"

**Мета роботи:** Навчитися слідувати принципам чистого коду та реалізовувати потрібні патерни програмування в програмному коді.

## Завдання

### Завдання 1: Опис проєкту

Цей проєкт являє собою класичну гру "Сапер", розроблену з використанням HTML, CSS, JavaScript та PHP для збереження статистики гравців. Гра має три рівні складності, графічний інтерфейс користувача та можливість зберігати результати гри в базі даних.

**Основна функціональність:**

* **Різні рівні складності:** Легкий (9x9, 10 мін), Середній (16x16, 40 мін), Складний (16x30, 99 мін). Користувач може обрати рівень перед початком гри.
* **Генерація ігрового поля:** Динамічне створення ігрової дошки заданого розміру з випадковим розміщенням мін. Перший клік на порожню клітинку гарантує відсутність міни.
* **Відкриття клітинок:** Клік на клітинку відкриває її. Якщо під клітинкою міна - гра закінчується. Якщо поруч немає мін, автоматично відкриваються сусідні порожні клітинки.
* **Позначення мін прапорцями:** Користувач може позначати клітинки, які, на його думку, містять міни, використовуючи правий клік миші.
* **Таймер:** Фіксується час, витрачений на проходження гри.
* **Збереження результатів:** Після успішного завершення гри час проходження та рівень складності зберігаються в базі даних MySQL разом з ім'ям гравця (яке вводиться при вході).
* **Таблиця лідерів:** Доступна сторінка з рейтингом топ-5 гравців для кожного рівня складності, відсортованих за найменшим часом проходження.
* **Аутентифікація користувачів:** Перед початком гри користувачу пропонується ввести ім'я, яке використовується для збереження його результатів.

**Посилання на файли з реалізацією функціональності:**

* Генерація ігрового поля та логіка гри: [https://www.google.com/search?q=js/board.js](https://www.google.com/search?q=js/board.js)
* Відображення ігрового поля: [js/renderer.js](js/renderer.js)
* Керування таймером: [js/timer.js](js/timer.js)
* Обробка вибору рівня складності та рестарту гри: [js/main.js](js/main.js)
* Конфігурація підключення до бази даних: [db\_config.php](db_config.php)
* Отримання статистики для таблиці лідерів: [get\_stats.php](get_stats.php)
* Основна сторінка гри: [index.php](index.php)
* Сторінка таблиці лідерів: [leaderboard.php](leaderboard.php)
* Сторінка входу користувача: [login.php](login.php)
* Обробка виходу користувача: [logout.php](logout.php)
* Збереження результатів гри в БД: [save\_score.php](save_score.php)

**Кількість рядків коду (приблизно):**

```bash
411 рядків коду

Завдання 2: Опис функціоналу і краси коду
Процес запуску локально:
Клонуйте репозиторій:
Bash

git clone <URL вашого репозиторію>
cd <назва вашого репозиторію>
Налаштуйте базу даних:
Переконайтеся, що у вас встановлено MySQL або інший сумісний сервер баз даних.
Створіть базу даних з назвою minesweeper.
Імпортуйте SQL-запит для створення таблиці scores (якщо такий є, або створіть таблицю зі стовпцями player_name (VARCHAR), time_seconds (INT), difficulty (VARCHAR)).
Налаштуйте підключення до бази даних у файлі db_config.php, вказавши правильні значення для $host, $user, $password та $dbname.
Запустіть локальний веб-сервер:
Використовуйте Apache, Nginx або інший веб-сервер.
Переконайтеся, що PHP встановлено та налаштовано для обробки PHP-файлів.
Розмістіть файли проєкту в кореневій директорії вашого веб-сервера (або налаштуйте віртуальний хост).
Відкрийте гру у браузері:
Перейдіть за адресою http://localhost/<шлях до проєкту>/login.php (або за іншою адресою, залежно від налаштувань вашого веб-сервера).
Введіть своє ім'я та натисніть "Увійти".
Programming Principles
У цьому проєкті було дотримано наступних принципів програмування:

Single Responsibility Principle (SRP): Кожен клас (наприклад, Board, Renderer, GameTimer) має чітко визначену відповідальність. Клас Board відповідає за логіку гри, Renderer - за відображення ігрового поля, а GameTimer - за керування часом.
Open/Closed Principle (OCP): Класи є відкритими для розширення, але закритими для модифікації. Наприклад, додавання нового рівня складності не вимагає зміни існуючого коду класу Board, а досягається шляхом додавання нової гілки if/else if у методі setDifficulty. У майбутньому можна використати патерн Стратегія для більш гнучкого розширення.
Liskov Substitution Principle (LSP): (У цьому проєкті цей принцип не є явно застосовним через відсутність глибокої ієрархії успадкування, але при подальшому розширенні слід враховувати цей принцип при створенні підкласів).
Interface Segregation Principle (ISP): (У проєкті немає великої кількості інтерфейсів, але класи розроблені таким чином, щоб мати чітко визначені методи, що зменшує ймовірність потреби в "товстих" інтерфейсах).
Dependency Inversion Principle (DIP): Класи високого рівня (наприклад, Board, який залежить від Renderer та GameTimer) залежать від абстракцій (у даному випадку - від конкретних класів, але в майбутньому можна ввести інтерфейси для більшої гнучкості).
Design Patterns
У проєкті використано наступні патерни проєктування:

Module Pattern (в JavaScript файлах): Кожен JavaScript файл (board.js, renderer.js, timer.js, main.js) можна розглядати як модуль, який інкапсулює свою функціональність та надає обмежений інтерфейс для взаємодії з іншими частинами коду (через import та export). Це допомагає уникнути глобальних змінних та покращує організацію коду.
Приклад: У файлі js/board.js клас Board інкапсулює всю логіку ігрового поля.
Factory Pattern (проста реалізація в Board): Метод setDifficulty класу Board можна розглядати як просту фабрику, яка на основі переданого рівня складності встановлює відповідні параметри гри (rows, cols, mines). Хоча це не є повноцінною реалізацією патерну Фабрика, вона інкапсулює логіку створення об'єкта (фактично - налаштування параметрів) залежно від вхідних даних.
Приклад: Метод js/board.js#L11-L25 класу Board.
Observer Pattern (через обробники подій): Взаємодія між елементами DOM (кнопки, клітинки) та JavaScript-кодом відбувається за допомогою обробників подій (addEventListener). Це є прикладом патерну Спостерігач, де елементи DOM є "суб'єктами", а функції обробників подій - "спостерігачами", які реагують на певні події.
Приклад: Обробники кліків на клітинках (js/renderer.js#L11-L18) та кнопках зміни складності (js/main.js#L7-L12).
Refactoring Techniques
Під час написання програми було застосовано наступні техніки рефакторингу:

Extract Function (Виділення функції): Логіка обробки кліку на клітинку була винесена в окремий метод handleClick класу Board (js/board.js#L59-L69) для покращення читабельності та зменшення дублювання коду.
Rename Variable/Function (Перейменування змінної/функції): Змінні та функції були названі таким чином, щоб чітко відображати їх призначення (наприклад, rows, cols, mines, revealCell, toggleFlag).
Replace Magic Number with Symbolic Constant (Заміна магічних чисел символьними константами): Хоча в даному коді це не всюди застосовано, розміри клітинок (30px) у файлі js/renderer.js#L3 та кількість мін для різних рівнів складності в js/board.js#L14-L23 є потенційними кандидатами для винесення в константи для покращення розуміння та полегшення майбутніх змін.
Decompose Conditional (Декомпозиція умовного оператора): У методі setDifficulty класу Board (js/board.js#L11-L25) логіка для кожного рівня складності розділена на окремі блоки if/else if, що робить код більш читабельним.
Introduce Parameter Object (Введення об'єкта-параметра): (У даному проєкті ця техніка не є явно використаною, але при розширенні функціональності методів, які приймають багато пов'язаних параметрів, її застосування могло б покращити читабельність та зменшити кількість параметрів).
Завдання 3: Класна програма
Структура файлів та директорій проєкту є логічною та зрозумілою:

.
├── js/
│   ├── board.js        // Логіка ігрового поля
│   ├── main.js         // Основний скрипт, ініціалізація гри
│   ├── renderer.js     // Відображення ігрового поля
│   └── timer.js        // Керування таймером
├── db_config.php       // Конфігурація підключення до БД
├── get_stats.php       // Отримання статистики для лідерборду
├── index.php           // Основна сторінка гри
├── leaderboard.php     // Сторінка таблиці лідерів
├── login.php           // Сторінка входу користувача
├── logout.php          // Обробка виходу користувача
├── save_score.php      // Збереження результатів гри
└── style.css           // Стилі оформлення
Код написаний з урахуванням принципів чистого коду, наскільки це можливо в рамках даного проєкту. Змінні та функції мають описові назви, код розбитий на невеликі, зрозумілі блоки, а логіка гри інкапсульована в класах.

Використання Git:

Розробка проєкту велася з використанням системи контролю версій Git. Очікується наявність історії комітів, що відображає етапи розробки, а також використання окремих гілок для розробки нових фіч з подальшим їх злиттям через Pull Requests (якщо це було частиною процесу розробки).
